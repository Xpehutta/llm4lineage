INSERT INTO s_grnplm_vd_t_bvd_db_dmslcl.d_agr_cred_dmcl_attr  WITH cte_agr_cred_qlty_period AS (
         SELECT crd.host_eks_agr_id,
            t.start_dt,
            t.end_dt,
            t.agr_qlty_cat_type_id,
            t.agr_srv_qlty_type_id,
            t.cred_worthiness_id,
            t.prvsn_port_flag
           FROM (s_grnplm_vd_t_bvd_db_dmcl.a_agr_cred_qlty_period t
             JOIN s_grnplm_vd_t_bvd_db_dmcl.d_agr_cred crd ON ((t.agr_cred_id = crd.agr_cred_id)))
          WHERE (crd.agr_cred_id = crd.prnt_agr_cred_id)
        ), pprb_attr_val AS (
         SELECT cte_agr_cred_qlty_period.host_eks_agr_id,
            cte_agr_cred_qlty_period.start_dt,
            cte_agr_cred_qlty_period.end_dt,
            'agr_qlty_cat_type_id'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            cte_agr_cred_qlty_period.agr_qlty_cat_type_id AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM cte_agr_cred_qlty_period
          WHERE (cte_agr_cred_qlty_period.agr_qlty_cat_type_id IS NOT NULL)
        UNION ALL
         SELECT cte_agr_cred_qlty_period.host_eks_agr_id,
            cte_agr_cred_qlty_period.start_dt,
            cte_agr_cred_qlty_period.end_dt,
            'agr_srv_qlty_type_id'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            cte_agr_cred_qlty_period.agr_srv_qlty_type_id AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM cte_agr_cred_qlty_period
          WHERE (cte_agr_cred_qlty_period.agr_srv_qlty_type_id IS NOT NULL)
        UNION ALL
         SELECT cte_agr_cred_qlty_period.host_eks_agr_id,
            cte_agr_cred_qlty_period.start_dt,
            cte_agr_cred_qlty_period.end_dt,
            'prvsn_port_flag'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            NULL::uuid AS attr_val_uuid,
            cte_agr_cred_qlty_period.prvsn_port_flag AS attr_val_text
           FROM cte_agr_cred_qlty_period
          WHERE (cte_agr_cred_qlty_period.prvsn_port_flag IS NOT NULL)
        UNION ALL
         SELECT cte_agr_cred_qlty_period.host_eks_agr_id,
            cte_agr_cred_qlty_period.start_dt,
            cte_agr_cred_qlty_period.end_dt,
            'cred_worthiness_id'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            cte_agr_cred_qlty_period.cred_worthiness_id AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM cte_agr_cred_qlty_period
          WHERE (cte_agr_cred_qlty_period.cred_worthiness_id IS NOT NULL)
        UNION ALL
         SELECT crd.host_eks_agr_id,
            t.start_dt,
            t.end_dt,
            'cust_fin_pos_type_id'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            t.cust_fin_pos_type_id AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM (s_grnplm_vd_t_bvd_db_dmcl.a_agr_cred_clsfctn_fin_pos_period t
             JOIN s_grnplm_vd_t_bvd_db_dmcl.d_agr_cred crd ON (((t.agr_cred_id = crd.agr_cred_id) AND (crd.agr_cred_id = crd.prnt_agr_cred_id))))
        UNION ALL
         SELECT crd.host_eks_agr_id,
            t.start_dt,
            t.end_dt,
            'f303_inf_type_id'::text AS attr_name,
            NULL::numeric AS attr_val_numeric,
            t.f303_inf_type_id AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM (s_grnplm_vd_t_bvd_db_dmcl.a_agr_cred_f303_inf_type_period t
             JOIN s_grnplm_vd_t_bvd_db_dmcl.d_agr_cred crd ON (((t.agr_cred_id = crd.agr_cred_id) AND (crd.agr_cred_id = crd.prnt_agr_cred_id))))
        UNION ALL
         SELECT crd.host_eks_agr_id,
            t.start_dt,
            t.end_dt,
            'prvsn_rate'::text AS attr_name,
            t.prvsn_rate AS attr_val_numeric,
            NULL::uuid AS attr_val_uuid,
            NULL::text AS attr_val_text
           FROM (s_grnplm_vd_t_bvd_db_dmcl.a_agr_cred_prvsn_period t
             JOIN s_grnplm_vd_t_bvd_db_dmcl.d_agr_cred crd ON (((t.agr_cred_id = crd.agr_cred_id) AND (crd.agr_cred_id = crd.prnt_agr_cred_id))))
        ), high_level_agr AS (
         SELECT t2_1.agr_cred_id,
            t1_1.host_eks_agr_id AS host_agr_cred_id,
            t1_1.start_dt,
            t1_1.end_dt,
            t1_1.attr_name,
            t1_1.attr_val_numeric,
            t1_1.attr_val_uuid,
            (abs(uuid_hash(t1_1.attr_val_uuid)))::bigint AS attr_val_uuid2bigint,
            t1_1.attr_val_text
           FROM (pprb_attr_val t1_1
             JOIN s_grnplm_vd_t_bvd_db_dmslcl.d_agr_cred_tmp t2_1 ON ((t1_1.host_eks_agr_id = t2_1.host_agr_cred_id)))
        )
 SELECT t2.agr_cred_id,
    t1.host_agr_cred_id,
    t1.start_dt,
    t1.end_dt,
    t1.attr_name,
    t1.attr_val_numeric,
    t1.attr_val_uuid,
    t1.attr_val_uuid2bigint,
    t1.attr_val_text
   FROM (high_level_agr t1
     JOIN s_grnplm_vd_t_bvd_db_dmslcl.d_agr_cred_prnt_tmp t2 ON ((t1.agr_cred_id = t2.prnt_agr_cred_id)))